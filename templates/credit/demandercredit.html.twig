{% extends 'base.html.twig' %}

    {% block body %}
    
        <script>
            // Fonction pour calculer automatiquement les frais de retard et le taux d'intérêt
            function calculerFraisTaux() {
              var montant = parseFloat(document.getElementById("montant").value);
              var duree = parseInt(document.getElementById("duree").value);
              var mensualite = parseFloat(
                document.getElementById("mensualite").value
              );
      
              // Calcul des frais de retard (exemple: 1% du montant)
              var frais_retard = montant * 0.01;
              document.getElementById("frais_retard").value = frais_retard.toFixed(2);
      
              // Calcul du taux d'intérêt (exemple: taux annuel = (mensualité * durée - montant) / montant)
              var taux_annuel =
                (((mensualite * duree - montant) / montant) * 12) / duree;
              document.getElementById("taux_interet").value = taux_annuel.toFixed(2);
            }
            function afficherChampConsultation() {
              var radio = document.querySelector(
                'input[name="prendre_rendezvous"]:checked'
              );
      
              if (radio && radio.value === "oui") {
                window.location.href = "{{path('app_demanderrdv')}}"; // Redirection vers la page rendezvous.html
              }
            }
          </script>
        </head>
      
        <body class="vh-100">
          <div class="authincation h-100">
            <div class="container h-100">
              <div class="row justify-content-center h-100 align-items-center">
                <div class="col-md-6">
                  <div class="authincation-content">
                    <div class="row no-gutters">
                      <div class="col-xl-12">
                        <div class="auth-form">
                          <div class="text-center mb-3">
                            <a href="index.html"
                              ><img src="images/logo-full.png" alt=""
                            /></a>
                          </div>
                          <!-- Formulaire pour ajouter une demande de crédit -->
                          <form action="create_demande_credit.php" method="POST">
                            <div class="mb-3">
                              <label class="mb-1"><strong>ID Demande</strong></label>
                              <input
                                type="number"
                                class="form-control"
                                name="id_demande"
                                required
                              />
                            </div>
                            <div class="mb-3">
                              <label class="mb-1"><strong>ID Client</strong></label>
                              <input
                                type="number"
                                class="form-control"
                                name="id_client"
                                required
                              />
                            </div>
                            <div class="mb-3">
                              <label class="mb-1"><strong>Montant</strong></label>
                              <input
                                type="number"
                                step="0.01"
                                class="form-control"
                                name="montant"
                                id="montant"
                                required
                                oninput="calculerFraisTaux()"
                              />
                            </div>
                            <div class="mb-3">
                              <label class="mb-1"
                                ><strong>Statut Client</strong></label
                              >
                              <input
                                type="text"
                                class="form-control"
                                name="status_client"
                                required
                              />
                            </div>
                            <div class="mb-3">
                              <label class="mb-1"><strong>Mensualité</strong></label>
                              <input
                                type="number"
                                step="0.01"
                                class="form-control"
                                name="mensualite"
                                id="mensualite"
                                required
                                oninput="calculerFraisTaux()"
                              />
                            </div>
                            <div class="mb-3">
                              <label class="mb-1"
                                ><strong>Date de début</strong></label
                              >
                              <input
                                type="date"
                                class="form-control"
                                name="date_debut"
                                required
                              />
                            </div>
                            <div class="mb-3">
                              <label class="mb-1"
                                ><strong>Durée (en mois)</strong></label
                              >
                              <input
                                type="number"
                                class="form-control"
                                name="duree"
                                id="duree"
                                required
                                oninput="calculerFraisTaux()"
                              />
                            </div>
                            <div class="mb-3">
                              <label class="mb-1"
                                ><strong>Taux d'intérêt</strong></label
                              >
                              <input
                                type="number"
                                step="0.01"
                                class="form-control"
                                name="taux_interet"
                                id="taux_interet"
                                readonly
                              />
                            </div>
                            <div class="mb-3" style="display: none">
                              <label class="mb-1"><strong>Status</strong></label>
                              <select class="form-control" name="status" required>
                                <option value="en cours">En cours</option>
                                <option value="remboursé">Remboursé</option>
                              </select>
                            </div>
                            <div class="mb-3">
                              <label class="mb-1"
                                ><strong>Frais de retard</strong></label
                              >
                              <input
                                type="number"
                                class="form-control"
                                name="frais_de_retard"
                                id="frais_retard"
                                readonly
                              />
                            </div>
                            <div class="mb-3">
                              <label class="mb-1"
                                ><strong>Consultation de crédit</strong></label
                              ><br />
                              <input
                                type="radio"
                                name="prendre_rendezvous"
                                value="oui"
                                onclick="afficherChampConsultation()"
                              />
                              Oui
                              <input
                                type="radio"
                                name="prendre_rendezvous"
                                value="non"
                                onclick="afficherChampConsultation()"
                              />
                              Non
                            </div>
      
                            <div class="text-center">
                              <button type="submit" class="btn btn-primary btn-block">
                                Ajouter la demande de crédit
                              </button>
                            </div>
                          </form>
                          <!-- Fin du formulaire pour ajouter une demande de crédit -->
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
    {% endblock %}